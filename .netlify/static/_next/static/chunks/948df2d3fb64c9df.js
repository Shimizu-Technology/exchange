(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15570,e=>{"use strict";var s=e.i(43476);e.i(50711);var a=e.i(82045),t=e.i(83394),i=e.i(75157),l=e.i(46932),n=e.i(94983),r=e.i(84614),c=e.i(22016);function d(){let e=(0,a.useQuery)(t.api.messages.listConversations),i=(0,a.useQuery)(t.api.users.getMe);return i?void 0===e?(0,s.jsxs)("div",{className:"max-w-xl mx-auto px-4 py-6",children:[(0,s.jsx)("h1",{className:"font-display text-2xl font-bold mb-6",children:"Messages"}),Array.from({length:4}).map((e,a)=>(0,s.jsxs)("div",{className:"flex items-center gap-3 p-4 animate-pulse",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-full bg-near-black/5"}),(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,s.jsx)("div",{className:"h-4 w-1/3 bg-near-black/5 rounded"}),(0,s.jsx)("div",{className:"h-3 w-2/3 bg-near-black/5 rounded"})]})]},a))]}):(0,s.jsxs)("div",{className:"max-w-xl mx-auto px-4 py-6",children:[(0,s.jsx)("h1",{className:"font-display text-2xl font-bold mb-6",children:"Messages"}),0===e.length?(0,s.jsxs)("div",{className:"text-center py-16",children:[(0,s.jsx)(n.MessageCircle,{className:"w-16 h-16 text-hot-pink/20 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"font-display text-lg font-bold mb-2",children:"No messages yet"}),(0,s.jsx)("p",{className:"text-warm-gray text-sm",children:"Start a conversation by tapping “I Want This” on any listing."})]}):(0,s.jsx)("div",{className:"space-y-1",children:e.map((e,a)=>(0,s.jsx)(x,{conversation:e,currentUserId:i._id,index:a},e._id))})]}):(0,s.jsxs)("div",{className:"max-w-xl mx-auto px-4 py-20 text-center",children:[(0,s.jsx)(n.MessageCircle,{className:"w-16 h-16 text-hot-pink/20 mx-auto mb-4"}),(0,s.jsx)("h2",{className:"font-display text-xl font-bold mb-2",children:"Sign in to see your messages"}),(0,s.jsx)("p",{className:"text-warm-gray text-sm",children:"Start a conversation by tapping “I Want This” on any listing."})]})}function x({conversation:e,currentUserId:n,index:d}){let x=e.buyerId===n,m=x?e.sellerId:e.buyerId,o=(0,a.useQuery)(t.api.users.get,{id:m}),h=(0,a.useQuery)(t.api.listings.get,{id:e.listingId}),u=x?e.buyerUnread:e.sellerUnread;return(0,s.jsx)(l.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05*d,duration:.3},children:(0,s.jsxs)(c.default,{href:`/messages/${e._id}`,className:"flex items-center gap-3 p-4 rounded-2xl hover:bg-white transition-colors group",children:[(0,s.jsxs)("div",{className:"relative w-12 h-12 rounded-full bg-hot-pink/10 flex items-center justify-center flex-shrink-0",children:[o?.avatarUrl?(0,s.jsx)("img",{src:o.avatarUrl,alt:"",className:"w-12 h-12 rounded-full"}):(0,s.jsx)(r.User,{className:"w-6 h-6 text-hot-pink"}),u>0&&(0,s.jsx)("span",{className:"absolute -top-0.5 -right-0.5 w-5 h-5 bg-hot-pink text-white text-[10px] font-bold rounded-full flex items-center justify-center",children:u>9?"9+":u})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:`font-medium text-sm truncate ${u>0?"font-bold":""}`,children:o?.name??"Loading..."}),(0,s.jsx)("span",{className:"text-xs text-warm-gray ml-2 whitespace-nowrap",children:(0,i.formatTimeAgo)(e.lastMessageAt)})]}),h&&(0,s.jsx)("p",{className:"text-xs text-hot-pink truncate",children:h.title}),e.lastMessagePreview&&(0,s.jsx)("p",{className:`text-sm truncate ${u>0?"text-near-black":"text-warm-gray"}`,children:e.lastMessagePreview})]})]})})}e.s(["default",()=>d])}]);