module.exports=[76472,a=>{"use strict";let b=(0,a.i(70106).default)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]);a.s(["Heart",()=>b],76472)},210,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},15375,a=>{"use strict";var b=a.i(87924),c=a.i(50944);a.i(11241);var d=a.i(96373),e=a.i(1322),f=a.i(68114),g=a.i(72131),h=a.i(46271),i=a.i(210);let j=(0,a.i(70106).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var k=a.i(46842),l=a.i(76472),m=a.i(38246);function n(){let a=(0,c.useParams)(),n=(0,c.useRouter)(),o=a.id,p=(0,d.useQuery)(e.api.messages.getConversation,{id:o}),q=(0,d.useQuery)(e.api.messages.listMessages,{conversationId:o}),r=(0,d.useQuery)(e.api.users.getMe),s=(0,d.useMutation)(e.api.messages.sendMessage),t=(0,d.useMutation)(e.api.messages.markRead),u=(0,d.useQuery)(e.api.listings.get,p?{id:p.listingId}:"skip"),v=p?p.buyerId===r?._id?p.sellerId:p.buyerId:void 0,w=(0,d.useQuery)(e.api.users.get,v?{id:v}:"skip"),[x,y]=(0,g.useState)(""),z=(0,g.useRef)(null);(0,g.useEffect)(()=>{p&&r&&t({conversationId:o})},[p,r,q?.length,o,t]),(0,g.useEffect)(()=>{z.current&&(z.current.scrollTop=z.current.scrollHeight)},[q?.length]);let A=async()=>{if(!x.trim())return;let a=x.trim();y(""),await s({conversationId:o,text:a})};return p&&r?(0,b.jsxs)("div",{className:"max-w-xl mx-auto flex flex-col h-[calc(100vh-4rem)] md:h-[calc(100vh-5rem)]",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3 border-b border-near-black/5 bg-white/80 backdrop-blur-sm",children:[(0,b.jsx)("button",{onClick:()=>n.push("/messages"),className:"text-warm-gray hover:text-near-black transition-colors",children:(0,b.jsx)(i.ArrowLeft,{className:"w-5 h-5"})}),(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-hot-pink/10 flex items-center justify-center flex-shrink-0",children:w?.avatarUrl?(0,b.jsx)("img",{src:w.avatarUrl,alt:"",className:"w-10 h-10 rounded-full"}):(0,b.jsx)(k.User,{className:"w-5 h-5 text-hot-pink"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-sm truncate",children:w?.name??"..."}),u&&(0,b.jsxs)(m.default,{href:`/listing/${u._id}`,className:"text-xs text-hot-pink truncate block hover:underline",children:[u.title," · ",(0,f.formatPrice)(u.price)]})]})]}),u&&(0,b.jsxs)(m.default,{href:`/listing/${u._id}`,className:"flex items-center gap-3 px-4 py-2.5 bg-warm-white border-b border-near-black/5 hover:bg-white transition-colors",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-hot-pink/10 to-electric-yellow/10 flex items-center justify-center flex-shrink-0 overflow-hidden",children:u.photos[0]?(0,b.jsx)("img",{src:u.photos[0],alt:"",className:"w-10 h-10 object-cover"}):(0,b.jsx)(l.Heart,{className:"w-4 h-4 text-hot-pink/30"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-xs font-medium truncate",children:u.title}),(0,b.jsx)("p",{className:"text-xs text-hot-pink font-bold",children:(0,f.formatPrice)(u.price)})]})]}),(0,b.jsxs)("div",{ref:z,className:"flex-1 overflow-y-auto px-4 py-4 space-y-3",children:[q?.length===0&&(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("p",{className:"text-warm-gray text-sm",children:"Start the conversation!"}),(0,b.jsx)("button",{onClick:()=>{y("Is this still available?")},className:"mt-3 px-4 py-2 bg-white rounded-full border border-near-black/10 text-sm text-warm-gray hover:text-hot-pink hover:border-hot-pink/20 transition-colors",children:"“Is this still available?”"})]}),q?.map((a,c)=>{let d=a.senderId===r._id;return(0,b.jsx)(h.motion.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{duration:.2},className:`flex ${d?"justify-end":"justify-start"}`,children:(0,b.jsxs)("div",{className:`max-w-[80%] px-4 py-2.5 rounded-2xl ${d?"bg-hot-pink text-white rounded-br-md":"bg-white border border-near-black/5 rounded-bl-md"}`,children:[(0,b.jsx)("p",{className:"text-sm leading-relaxed",children:a.text}),(0,b.jsx)("p",{className:`text-[10px] mt-1 ${d?"text-white/60":"text-warm-gray"}`,children:(0,f.formatTimeAgo)(a.createdAt)})]})},a._id)})]}),(0,b.jsx)("div",{className:"px-4 py-3 border-t border-near-black/5 bg-white",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"text",value:x,onChange:a=>y(a.target.value),onKeyDown:a=>"Enter"===a.key&&A(),placeholder:"Type a message...",className:"flex-1 px-4 py-3 bg-warm-white rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-hot-pink/10"}),(0,b.jsx)("button",{onClick:A,disabled:!x.trim(),className:"p-3 bg-hot-pink text-white rounded-2xl hover:bg-hot-pink-dark disabled:opacity-30 transition-all",children:(0,b.jsx)(j,{className:"w-5 h-5"})})]})})]}):(0,b.jsx)("div",{className:"max-w-xl mx-auto px-4 py-8",children:(0,b.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,b.jsx)("div",{className:"h-16 bg-near-black/5 rounded-xl"}),(0,b.jsx)("div",{className:"h-[60vh] bg-near-black/5 rounded-xl"})]})})}a.s(["default",()=>n],15375)}];

//# sourceMappingURL=_ab80b685._.js.map